<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Profissionais — Mineiro Barbershop</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/styles.css">
  <style>
    /* Usa o mesmo visual da lista de serviços */
    .pro-list{ padding:12px 14px 14px; display:grid; gap:14px; }
    /* Estado desativado para quem não faz o(s) procedimento(s) */
    .item.is-disabled{ opacity:.5; filter:grayscale(.15); }
    .item.is-disabled .choose{ pointer-events:none; opacity:.65; border-style:dashed; }
    .item .name .rate{ font-weight:700; color:#f7c948; margin-left:8px; font-size:12px }
  </style>
</head>
<body>

<main class="app" aria-labelledby="title">
  <header class="topbar">
    <a class="back ripple" href="services.html" aria-label="Voltar">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"/></svg>
    </a>
    <h1 id="title">Profissionais</h1>
  </header>

  <!-- Lista de profissionais no mesmo padrão da services -->
  <section class="list pro-list" aria-label="Profissionais">
    <!-- Fernando -->
    <article class="item reveal" data-id="fernando" data-skills="corte barba">
      <figure class="thumb"><img src="img/pro-fernando.jpg" alt="Fernando" loading="lazy"></figure>
      <div class="meta">
        <h3 class="name">Fernando <span class="rate">★ 4,8</span></h3>
        <p class="desc">Barbeiro • Corte e Barba</p>
      </div>
      <button class="choose ripple" type="button" aria-pressed="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        <span>Escolher</span>
      </button>
    </article>

    <!-- Jonnier -->
    <article class="item reveal" data-id="jonnier" data-skills="coloracao corte">
      <figure class="thumb"><img src="img/pro-jonnier.jpg" alt="Jonnier" loading="lazy"></figure>
      <div class="meta">
        <h3 class="name">Jonnier <span class="rate">★ 4,7</span></h3>
        <p class="desc">Stylist • Corte e Coloração</p>
      </div>
      <button class="choose ripple" type="button" aria-pressed="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        <span>Escolher</span>
      </button>
    </article>

    <!-- Marcos -->
    <article class="item reveal" data-id="marcos" data-skills="corte">
      <figure class="thumb"><img src="img/pro-marcos.jpg" alt="Marcos" loading="lazy"></figure>
      <div class="meta">
        <h3 class="name">Marcos <span class="rate">★ 4,6</span></h3>
        <p class="desc">Barbeiro • Corte masculino</p>
      </div>
      <button class="choose ripple" type="button" aria-pressed="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        <span>Escolher</span>
      </button>
    </article>

    <!-- Aline -->
    <article class="item reveal" data-id="aline" data-skills="coloracao tratamento sobrancelha">
      <figure class="thumb"><img src="img/pro-aline.jpg" alt="Aline" loading="lazy"></figure>
      <div class="meta">
        <h3 class="name">Aline <span class="rate">★ 4,9</span></h3>
        <p class="desc">Colorista • Coloração, Tratamento e Sobrancelha</p>
      </div>
      <button class="choose ripple" type="button" aria-pressed="false">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>
        <span>Escolher</span>
      </button>
    </article>
  </section>

  <!-- Rodapé (resumo + ações) -->
  <div class="pro-bar">
    <div class="summary" id="sum">R$ 0,00 • 0 serviço • 0 min</div>
    <button class="btn ripple" id="btnBack">Voltar</button>
    <button class="btn btn-primary ripple" id="btnNext" disabled>Continuar</button>
  </div>
</main>

<script>
/* ===== Helpers & estado dos serviços selecionados ===== */
const BRL = v => 'R$ ' + Number(v||0).toFixed(2).replace('.', ',');
const getStore = key => localStorage.getItem(key) ?? sessionStorage.getItem(key);

// tokens dos serviços escolhidos na etapa anterior (ex.: corte, barba, coloracao...)
const REQUIRED = new Set(JSON.parse(getStore('svc.selected') || '[]'));
const total = Number(getStore('svc.total')||0);
const mins  = Number(getStore('svc.minutes')||0);
const count = Number(getStore('svc.count')||0);
document.getElementById('sum').textContent = `${BRL(total)} • ${count} serviço${count>1?'s':''} • ${mins} min`;

/* ===== Reveal suave ===== */
(() => {
  const io=new IntersectionObserver((ents)=>ents.forEach(e=>{if(e.isIntersecting){e.target.classList.add('is-in');io.unobserve(e.target);}}), {threshold:.12, rootMargin:"0px 0px -40px 0px"});
  document.querySelectorAll('.reveal').forEach(el=>io.observe(el));
})();

/* ===== Ripple ===== */
(() => {
  const add=(btn,e)=>{const r=document.createElement('span');r.className='r';const b=btn.getBoundingClientRect();r.style.left=(e.clientX-b.left)+'px';r.style.top=(e.clientY-b.top)+'px';btn.appendChild(r);r.addEventListener('animationend',()=>r.remove(),{once:true});};
  document.addEventListener('click',(e)=>{const btn=e.target.closest('.ripple'); if(btn) add(btn,e);},{passive:true});
})();

/* ===== Habilita/Desabilita conforme procedimentos ===== */
(() => {
  const cards = [...document.querySelectorAll('.pro-list .item')];
  cards.forEach(card=>{
    const skills=(card.dataset.skills||'').trim().split(/\s+/);
    const enabled = (REQUIRED.size===0) ? true : skills.some(s=>REQUIRED.has(s)); // precisa fazer pelo menos 1 dos selecionados
    const btn = card.querySelector('.choose');
    card.classList.toggle('is-disabled', !enabled);
    btn.disabled = !enabled;
    btn.setAttribute('aria-disabled', String(!enabled));
    if(!enabled){ btn.setAttribute('title','Não realiza o(s) procedimento(s) selecionado(s)'); }
  });
})();

/* ===== Seleção (igual services: botão Escolher) ===== */
(() => {
  const btnNext = document.getElementById('btnNext');
  const btnBack = document.getElementById('btnBack');
  const cards = [...document.querySelectorAll('.pro-list .item')].map(el => ({
    id: el.dataset.id,
    skills: (el.dataset.skills||'').trim().split(/\s+/),
    btn: el.querySelector('.choose'),
    el
  }));

  const selected = new Set(); // ids

  function updateNext(){
    const n = selected.size;
    btnNext.disabled = n===0;
    btnNext.textContent = n ? `Continuar (${n})` : 'Continuar';
  }

  cards.forEach(({id,btn,el})=>{
    btn.addEventListener('click', ()=>{
      if(btn.disabled) return;
      const on = btn.classList.toggle('is-on');
      btn.setAttribute('aria-pressed', on ? 'true' : 'false');
      if(on) selected.add(id); else selected.delete(id);
      updateNext();
    });
  });

  btnBack.addEventListener('click', ()=>{ window.location.href='services.html'; });

  btnNext.addEventListener('click', ()=>{
    if(selected.size===0) return;
    localStorage.setItem('selectedPros', JSON.stringify([...selected]));
    window.location.href = 'agendamentos.html';
  });

  updateNext();
})();

/* ===== fallback para imagens quebradas ===== */
document.querySelectorAll('.thumb img').forEach(img=>{
  img.addEventListener('error', ()=>{ const box=img.parentElement; img.remove(); box.classList.add('no-img'); });
});
</script>
</body>
</html>
